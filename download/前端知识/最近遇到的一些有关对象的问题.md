# 最近遇到的一些有关对象的问题

:::info
数组转对象后，如果对象的key是类似于数字的字符串或数字，那么转换出来的对象里面的元素无法保证和原来数组里面的元素相同的顺序，所以遇到这种情况，将数组转换成map，这样转换后的顺序就会保持。

:::

## **<font style="color:rgba(0, 0, 0, 0.9);">数组转对象时的顺序问题</font>**
1. 数组转对象的常见方式：

```javascript
const arr = [
  { id: 3, name: 'Tom' },
  { id: 1, name: 'Jerry' },
  { id: 2, name: 'Spike' }
];

// 方式一：普通对象（数字或数字字符串作为 key）
const obj = {};
arr.forEach(item => {
  obj[item.id] = item;
});
```

2. 遭遇的问题：
+ <font style="color:rgba(0, 0, 0, 0.9);">当对象的 key 是</font>**<font style="color:rgba(0, 0, 0, 0.9);">数字</font>**<font style="color:rgba(0, 0, 0, 0.9);">或</font>**<font style="color:rgba(0, 0, 0, 0.9);">类似数字的字符串</font>**<font style="color:rgba(0, 0, 0, 0.9);">（如 </font>`<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);">'1'</font>`<font style="color:rgba(0, 0, 0, 0.9);">, </font>`<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);">'2'</font>`<font style="color:rgba(0, 0, 0, 0.9);">, </font>`<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);">'3'</font>`<font style="color:rgba(0, 0, 0, 0.9);">）时，JavaScript 引擎会自动按照</font>**<font style="color:rgba(0, 0, 0, 0.9);">数字升序</font>**<font style="color:rgba(0, 0, 0, 0.9);">排列这些 key。</font>
+ <font style="color:rgba(0, 0, 0, 0.9);">因此，转换后的对象属性顺序</font>**<font style="color:rgba(0, 0, 0, 0.9);">无法保证</font>**<font style="color:rgba(0, 0, 0, 0.9);">与原始数组顺序一致。</font>
3. 解决方案：使用map数据结构

```javascript
const map = new Map();
arr.forEach(item => {
  map.set(item.id, item);
});
// 遍历 Map，顺序与数组一致
map.forEach((value, key) => {
  console.log(key, value);
});
```

+ `<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);">Map</font>`<font style="color:rgba(0, 0, 0, 0.9);"> 是 ES6 引入的数据结构，专门用于保存键值对。</font>
+ `<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(0, 0, 0, 0.03);">Map</font>`<font style="color:rgba(0, 0, 0, 0.9);"> 会</font>**<font style="color:rgba(0, 0, 0, 0.9);">严格记住键的插入顺序</font>**<font style="color:rgba(0, 0, 0, 0.9);">，遍历时会按照插入顺序返回键值对。</font>





> 更新: 2025-07-10 15:38:10  
> 原文: <https://www.yuque.com/quwaidi-exykz/lv0i4k/fuqi8qsu7lt5gadg>