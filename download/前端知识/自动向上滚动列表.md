# 自动向上滚动列表

特性：

+ 数据有限，但是视觉上实现无限滚动。
+ 鼠标悬停暂停滚动
+ 序号显示正确
+ 适用于数据可视化，大屏展示等场景

实现原理概述：

:::color1
首先将数据完整的复制一份，使用定时器控制滚动，鼠标进入滚动区域后，清除定时器，鼠标画出滚动区域后，重启定时器，实现继续滚动。序号显示正确使用取模运算。

:::

代码：

```sass
.auto-scroll-list {
    width: 400px;
    margin: 0 auto;
    font-family: Arial, sans-serif;
    color: #fff;
    background: #0a1a2f;
    padding: 10px;
    border-radius: 8px;
  }
  .header {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #225ab5;
    font-weight: bold;
  }
  .scroll-container {
    height: 300px;
    overflow: hidden;
    position: relative;
  }
  .content {
    width: 100%;
  }
  .list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid #1c3b68;
  }
  .progress-bar {
    display: flex;
    width: 150px;
    height: 20px;
    border-radius: 4px;
    overflow: hidden;
  }
  .done {
    background-color: #4caf50;
    text-align: center;
    color: #fff;
    line-height: 20px;
    font-size: 12px;
  }
  .doing {
    background-color: #ff9800;
    text-align: center;
    color: #fff;
    line-height: 20px;
    font-size: 12px;
  }
```

```tsx
import React, { useState, useEffect, useRef } from "react";
import "./index.scss"; // 样式文件
const AutoScrollList = () => {
  const [data, setData] = useState<any[]>([]);
  const [isScrolling, setIsScrolling] = useState(true);
  const scrollContainerRef = useRef<any>(null);
  const contentRef = useRef<any>(null);
  const cloneRef = useRef<any>(null);
  const scrollTimer = useRef<any>(null);
  // 模拟获取数据
  const fetchData = () => {
    const baseData = Array.from({ length: 11 }, (_, i) => ({
      id: i,
      name: `任务 ${i + 1}`,
      done: Math.floor(Math.random() * 100),
      doing: Math.floor(Math.random() * 50),
    }));
    setData([...baseData, ...baseData]); // 复制一份数据，变成22条
    // setData(baseData); // 复制一份数据
  };
  useEffect(() => {
    fetchData();
    const interval = setInterval(fetchData, 10000); // 每10秒更新一次数据
    return () => clearInterval(interval);
  }, []);
  // 滚动逻辑
  useEffect(() => {
    const scroll = () => {
      if (
        scrollContainerRef.current.scrollTop >=
        contentRef.current.scrollHeight / 2
      ) {
        scrollContainerRef.current.scrollTop = 0;
      } else {
        scrollContainerRef.current.scrollTop += 1;
      }
    };

    if (isScrolling) {
      scrollTimer.current = setInterval(scroll, 50); // 控制滚动速度
    } else {
      clearInterval(scrollTimer.current);
    }
    return () => clearInterval(scrollTimer.current);
  }, [isScrolling, data]);
  const handleMouseEnter = () => setIsScrolling(false);
  const handleMouseLeave = () => setIsScrolling(true);
  return (
    <div className="auto-scroll-list">
      <div className="header">
        <span>序号</span>
        <span>节点</span>
        <span>已完成/正在推送</span>
      </div>
      <div
        className="scroll-container"
        ref={scrollContainerRef}
        onMouseEnter={handleMouseEnter}
        onMouseLeave={handleMouseLeave}
      >
        <div className="content" ref={contentRef}>
          {data.map((item, index) => {
            const total = item.done + item.doing || 1;
            const donePercent = (item.done / total) * 100;
            const doingPercent = (item.doing / total) * 100;
            return (
              <div className="list-item" key={item.id}>
                <span>{(index % 11) + 1}</span>
                <span>{item.name}</span>
                <div className="progress-bar">
                  <div className="done" style={{ width: `${donePercent}%` }}>
                    {item.done}
                  </div>
                  <div className="doing" style={{ width: `${doingPercent}%` }}>
                    {item.doing}
                  </div>
                </div>
              </div>
            );
          })}
        </div>
        {/* <div className="content clone" ref={cloneRef}></div> */}
      </div>
    </div>
  );
};

export default AutoScrollList;

```







> 更新: 2025-07-10 17:06:26  
> 原文: <https://www.yuque.com/quwaidi-exykz/lv0i4k/kgb185eznro0aoyg>