+++
date = '2025-09-08T16:50:59+08:00'
draft = false
title = '大屏自适应函数'

categories=['自适应','JS']

+++

## `handleScreenAuto` 函数文档

### 目的

自适应调整数据大屏的显示，使其在不同分辨率的屏幕上保持设计稿的宽高比。

### 函数逻辑

1. 定义设计稿的宽度 (`designDraftWidth`) 和高度 (`designDraftHeight`)。
2. 获取包含大屏元素 (`#bigScreenV2`) 的父元素 (`documentElement`)。
3. 计算屏幕的宽高比与设计稿的宽高比，确定缩放比例 (`scale`)：
   - 如果屏幕的宽高比小于设计稿的宽高比，则按宽度比例缩放。
   - 否则，按高度比例缩放。
4. 获取大屏元素 (`dom`) 并应用缩放和平移变换：
   - 使用 `transform` 属性设置缩放和平移。
5. 计算调整后的大屏元素的宽度和高度，并设置到地图组件的宽度和高度 (`setMapWidthAndHeight`)。

### 示例代码

```tsx
const handleScreenAuto = () => {
  const designDraftWidth = 1920; // 设计稿的宽度
  const designDraftHeight = 1080; // 设计稿的高度
  const documentElement = largeScreenV2Ref.current.parentElement;
  // 根据屏幕的变化适配的比例
  const scale =
    documentElement.clientWidth / documentElement.clientHeight <
    designDraftWidth / designDraftHeight
      ? documentElement.clientWidth / designDraftWidth
      : documentElement.clientHeight / designDraftHeight;
  // 缩放比例
  const dom = document.querySelector("#bigScreenV2") as any;
  dom.style.transform = `scale(${scale}) translate(-50%)`;
  // 尝试重置地球的缩放比例
  const width = (dom.clientWidth * scale).toFixed(2);
  const height = (dom.clientHeight * scale).toFixed(2);
  setMapWidthAndHeight({
    width,
    height,
  });
};
useEffect(() => {
    if (largeScreenV2Ref.current) {
      //初始化自适应  ----在刚显示的时候就开始适配一次
      handleScreenAuto(); //绑定自适应函数   ---防止浏览器栏变化后不再适配
      window.onresize = () => handleScreenAuto(); //退出大屏后自适应消失   ---这是react的组件销毁生命周期
    }
    return () => {
      window.onresize = null;
    }; }, [largeScreenV2Ref]);
return (
    <div className="center-v2" ref={largeScreenV2Ref}>
      <div id="bigScreenV2">
      </div>
    </div>
  );
```

```scss
 #bigScreenV2 {
    display: inline-block;
    width: 1920px; //设计稿的宽度
    height: 1080px; //设计稿的高度
    transform-origin: 0 0;
    position: absolute;
    pointer-events:none;
    left: 50%;
    z-index: 2;
  }
```

### 注意事项

- 确保 `largeScreenV2Ref` 引用的元素存在且已正确初始化。
- 该函数假设大屏元素 (`#bigScreenV2`) 是绝对定位的，并且其父元素是相对定位的。
- 该函数可能需要在窗口大小变化时调用，例如通过监听 `window.resize` 事件。

### 使用场景

- 当需要在不同分辨率的屏幕上保持数据大屏的布局和比例时。
- 当需要动态调整地图组件的大小以适应大屏元素的变化时。
